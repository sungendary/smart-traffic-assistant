AI 데이트 코스 추천 플랫폼
커플의 감정과 취향을 이해하고,
함께 성장하는 관계를 만들어가는 새로운 데이트 경험

연인들의 데이트 장소, 활동, 리뷰 데이터를 종합 분석하여
개인화된 데이트 정보를 제공하는
지능형 추천 플랫폼을 구축합니다

단순한 데이트 추천 앱이 아니라, 연인의 감정·성향·행동
데이터를 바탕으로 AI가 함께 성장하는 관계 경험을
만들어주는 지능형 커플 플랫폼

[핵심기능]
기능1: 취향 기반 데이트 코스 추천

작동 방식
• 사용자 입력 문장 분석
• 감정 라벨 자동 분류
• 맞춤형 코스 매칭
• 실시간 추천 업데이트

감정별 추천 예시
    내향형 조용한 실내 카페 힐링 산책 코스
    외향형 활동형 액티비티 야경 명소 투어
    우울 밝은 분위기 레스토랑 코미디 공연

기능2: 커플 챌린지 보상 시스템
추천받은 장소를 방문하고 앱에서 체크하면 기록이 생성됩니다.
가본 장소 표기 및 미션 완료 시 지도에 이모티콘 추가
배지 해금
일정 수의 스탬프를 모으면 특별한 러브 배지를 획득하고 새로운
도전 과제가 열립니다.
관계 성장
커플의 활동 이력이 관계 성장 그래프로 시각화되어 함께한 추억을
확인할 수 있습니다.

기능3: AI 러브 스펙트럼
: 연인 관계 인사이트
커플이 데이트를 할수록 쌓이는 데이터를 기반으로
AI가 관계 성향을 자동분석 보고서입니다.

분석 데이터
• 데이트 활동 기록 패턴
• 리뷰 감정 분석
• 선호 장소 유형 및 빈도
• 시간대·요일별 활동 선호도….etc
매월 우리 커플 리포트 로 관계 인사이트 제공
별도의 설문 없이 자연스러운 사용만으로 커플만의 인사이트를 제공합니다.
[서비스 워크플로우]
1. **온보딩 & 계정 연결**
   - 사용자는 이메일 기반 회원가입/로그인을 진행한다. 로그인 이후 초대 코드를 통해 커플을 연결하거나, 기존 파트너의 요청을 승인한다.
   - 가입 직후 간단한 성향 설문(외향/내향, 선호 시간대 등)을 수집해 초기 개인화 모델의 기본값으로 사용한다.

2. **지도 홈 (허브, `/map`)**
   - 로그인 완료 시 기본 라우트는 `/map`. 화면 전체는 구글맵 유사 UI를 유지하며, 장소 검색·추천 인터랙션에 집중한다.
   - 상단 헤더에는 최소한의 글로벌 네비게이션(로고, `지도`, `플래너`, `커플`, `리포트`, 사용자 메뉴)을 배치한다. 개인화 기능은 지도 화면과 분리된 별도 페이지로 이동한다.
   - 지도 좌측 패널: 위치 검색/필터(감정 상태, 활동 세기 등). 우측에 노출되던 보조 패널은 `플래너` 페이지로 이동시키고, 지도 화면에는 간결한 추천 카드만 토스트/모달 형태로 띄운다.
   - 현재 위치 혹은 선택한 지역을 기준으로 FastAPI가 `GET /places/nearby`를 호출해 맞춤 장소를 제공하며, 사용자가 지도 마커/카드에서 상세 정보를 확인한다. 카드에서 "코스에 추가"를 누르면 `/planner` 라우트로 이동한다.

3. **개별 페이지 라우팅 구조**
   - `/planner` : 데이트 플래닝/북마크/코스 관리 페이지. 레이아웃은 좌측에 코스 목록, 중앙에 코스 상세(타임라인), 우측에 북마크/추천 스택으로 구성한다.
   - `/couple` : 커플 설정 페이지. 파트너 연결, 성향 설문 재작성, 알림/프라이버시 설정을 포함한다.
   - `/reports` : AI 러브 스펙트럼 리포트 허브. 월간 리포트 리스트 + 최신 리포트 요약 카드, 감정/장소 통계 차트 등을 제공.
   - `/settings` : 계정 정보, 앱 설정, 연동 서비스 관리.
   - 모바일에서는 하단 탭 바(지도/플래너/커플/리포트)를 제공해 동일한 라우팅을 지원한다.

3. **데이트 플래닝 (`/planner`)**
   - 사용자는 지도 화면에서 "코스에 추가"를 누르거나 `/planner`의 "장소 검색" 패널을 통해 장소를 선택한다. 선택 시 사이드 흘러가기(슬라이드오버)에서 코스 이름/일정/감정 목표를 입력한다.
   - 코스 생성 후 메인 뷰에는 타임라인(시간순 카드)과 지도 오버레이가 동시에 표시되며, 세부 편집(순서 변경/메모)은 `/planner` 전용 UI에서 수행한다.
   - 북마크와 저장된 코스는 탭으로 분리해 관리하고, 파트너 초대/공유 기능은 동일 페이지에서 제공한다.

4. **현장 체크인 & 기록**
   - 장소 방문 시 앱에서 체크인 하면(지도 카드의 "방문" 버튼), 위치 인증(geofence) 혹은 사진/리뷰 입력을 통해 방문 기록이 생성된다.
   - 방문 이후 리뷰 텍스트와 감정을 입력받아 감정 분석에 사용하고, 커플 활동 로그에 누적한다.

5. **챌린지 & 보상**
   - 방문 기록이 누적되면 챌린지(예: "야경 스팟 3곳 방문")가 자동 갱신된다. 조건 달성 시 배지를 부여하고 새로운 미션을 추천한다.
   - 우측 패널의 "북마크/챌린지" 탭에서 현재 진행 중인 미션과 배지 현황을 확인하고, 클릭 시 상세 페이지로 이동한다.

6. **AI 러브 스펙트럼 리포트 (`/reports`)**
   - 월 단위 리포트는 `/reports` 페이지에서 확인한다. 리스트 패널(좌측)에 월별 리포트 카드, 메인 패널(우측)에 선택한 리포트 상세를 노출한다.
   - 리포트 상세 요소: 감정 추이 그래프, 활동 밸런스, 장소/태그 TOP, 챌린지 진행도, LangChain 기반 자연어 요약 및 다음 달 제안.
   - LLM 요청은 백엔드에서 `/api/ai/suggest-itinerary` 또는 향후 `/api/ai/report`로 라우팅해 생성한다.

7. **알림 & 재참여 유도**
   - 새 챌린지 오픈, 미방문 추천 장소, 월간 리포트 발행 등 이벤트는 이메일/푸시 알림으로 사용자에게 전달된다.
   - 재접속 시 홈 화면에서 "이달의 추천", "다음 챌린지" 등을 상단 배너로 강조해 자연스럽게 서비스를 순환하도록 설계한다.

> 위 워크플로우는 초기 MVP 단계에서는 간소화된 기능(추천·북마크·방문 기록)에 집중하고, 이후 챌린지/리포트/알림을 순차적으로 추가한다는 로드맵을 가정한다. 제품 기획자는 각 단계의 사용자 여정을 기준으로 UX 흐름을 설계하고, 개발자는 대응 API 및 데이터 모델을 확장하면 된다.

[Detailed User Flow]
> 아래 흐름은 실제 프로덕트 설계 시 PM/UX 디자이너, 프런트엔드/백엔드 개발자가 참고할 수 있도록 단계별 상세 시나리오와 필요한 데이터·API를 기술한다.

1. **Landing → 회원가입/로그인 → 커플 연결**
   - 1-1. 사용자는 `landing` 뷰에서 서비스 소개, 핵심 가치, 샘플 리포트 등을 확인하고 `로그인` 버튼을 누른다.
   - 1-2. `회원가입` 선택 시
       - 입력폼: 이메일, 닉네임, 비밀번호, 약관 동의 체크박스.
       - 제출 → `POST /api/auth/signup` 호출 → 성공 시 "가입 완료" 토스트와 함께 로그인 화면으로 리다이렉트.
       - (차후) 이메일 인증 토큰 발송 로직 연결, 인증 상태를 `email_verified` 필드에 반영.
   - 1-3. `로그인` 성공(`POST /api/auth/login`) 후 즉시 **커플 연결 마법사** 실행:
       1) 초대 코드 입력 화면: 파트너가 보낸 코드(6자리)를 입력 → `POST /couples/join` (추가 예정) 호출 → 성공 시 커플 `couple_id`를 세션에 저장.
       2) 신규 생성: "초대 코드 만들기" 클릭 → `POST /couples/create` → 생성된 코드 공유 링크 제공(복사 버튼 + 카카오톡 공유 등).
       3) 파트너가 수락하면 `couple_members` 테이블 업데이트, 양측 모두 알림.
   - 1-4. 커플 연결 완료 후 **초기 성향 설문 모달** 표시:
       - 항목: 외향/내향, 선호 활동(활동적/감성적/힐링 등), 선호 시간대, 예산 범위, 자주 느끼는 감정.
       - 응답 값은 `PATCH /users/preferences` 로 저장, 추천 알고리즘 초기 파라미터로 사용.

2. **홈(메인 지도) 레이어 구조**
   - 2-1. 상단 헤더: 브랜드/메뉴/개인화 패널 토글, 알림 아이콘.
   - 2-2. 좌측 패널(뷰 라우팅):
       - 로그인 전: `LoginView` 카드만 노출.
       - 로그인 후: `MapControlView`로 전환. 필터 구성 요소:
         * 지역 선택 (현재 위치, 즐겨찾는 지역 드롭다운)
         * 감정 필터 (감정 스펙트럼: 설렘, 안정, 위로 등)
         * 카테고리 토글 (실내/실외, 식음료/액티비티/문화 등)
         * 시간대/예산 슬라이더
         * 키워드 검색 인풋 → `GET /api/places/nearby?latitude=...&tags=...`
       - 결과는 지도 마커 + 우측 카드로 동기화.
   - 2-3. 지도 영역:
       - 카카오 맵 SDK 초기화 후 사용자 위치 표시.
       - `state.lastPlaces`를 기반으로 마커 리스트, 클릭 시 상세 정보(사진, 평균 평점, 이용자 감정 요약 등) 표시.
       - 지도 우측 하단 플로팅 버튼: “새 코스 만들기”, “현재 코스 보기”.
   - 2-4. 우측 패널(토글 가능):
       - 탭 구조: 추천 / 북마크 / 코스 / 리포트 요약 / 챌린지.
       - 로그인 전에는 안내 카드만 보여주고 전체 패널을 숨김 상태로 유지.

3. **데이트 플래닝 기능**
   - 3-1. 추천 카드에서 `코스에 추가` 클릭 → `Course Builder` 모달 오픈.
       - 기본 흐름: (1) 장소 선택 → (2) 순서 정렬 → (3) 감정/테마 태그 → (4) 일정/노트.
       - 순서 정렬은 드래그 앤 드롭, 이동 수단 선택(도보/대중교통/차량) 시 예상 이동 시간 계산.
   - 3-2. 코스 저장 시 `POST /plans`
       - 요청 Body 예시:
```json
{
  "title": "봄밤 힐링 코스",
  "date": "2025-04-21",
  "couple_id": "...",
  "stops": [
    {"place_id": "sample-1", "order": 1, "note": "일몰 보기", "expected_time": "18:30"},
    {"place_id": "sample-2", "order": 2, "note": "디저트"}
  ],
  "emotion_goal": "힐링",
  "budget_range": "중간"
}
```
   - 3-3. 우측 패널의 "코스" 탭에서 생성한 코스를 리스트/카드로 제공. 각 코스에는 "시작하기", "지도에서 보기", "파트너에게 공유" 기능이 포함된다.
   - 3-4. 코스 공유는 `/plans/{id}/share` 엔드포인트로 링크 생성, 파트너에게 푸시/메일 발송.

4. **북마크 & 개인 노트**
   - 4-1. 장소 카드/마커에서 `★ 북마크` 클릭 → `POST /bookmarks`
       - Body: `{ "place_id": "...", "note": "기념일 후보" }`
       - 서버에서는 커플 전체 공유 북마크와 개인 북마크를 구분해 저장 (`scope: couple | user`).
   - 4-2. 우측 패널 `북마크` 탭에서 카테고리 필터(데이트/카페/야외 등), 정렬(최근/즐겨찾기) 적용 가능.
   - 4-3. 북마크 카드에서 바로 코스에 추가하거나 메모를 수정할 수 있도록 인라인 편집 제공.

5. **현장 체크인 & 리뷰 수집**
   - 5-1. 사용자가 코스 진행 시 지도 하단 플로팅 영역에서 "방문" 버튼 클릭.
   - 5-2. 클릭시 `POST /visits`
       - Body: `{ "plan_id": "...", "place_id": "...", "visited_at": "ISO8601", "emotion": "joy", "tags": ["데이트", "야경"], "memo": "야경이 정말 좋았음" }`
   - 5-3. 방문 후 1시간 내 리마인더 알림 → 리뷰 작성 화면 열기.
       - 리뷰는 감정 라벨(다중 선택 + 강도 슬라이더)과 자유 텍스트, 별점(1~5)으로 구성.
       - `POST /reviews` → 감정 분석 파이프라인으로 전달.

6. **챌린지/배지 시스템**
   - 6-1. 챌린지 데이터 구조: `{ id, title, description, criteria: { type: "visit_count", tag: "야경", count: 3 }, reward_badge_id, exp_points }`
   - 6-2. 서버는 방문 데이터 업데이트 시 챌린지 진행도를 갱신 (`/challenges/progress`).
   - 6-3. 배지 언락 시 알림 모달 + 애니메이션. 우측 패널 "챌린지" 탭에서 진행 중/완료/예정 분리.
   - 6-4. 배지 클릭 시 상세 설명과 해당 챌린지를 통해 얻은 인사이트(예: 감정 변화, 방문 장소 지도) 제공.

7. **AI 러브 스펙트럼 리포트**
   - 7-1. 월별 크론 작업이 `reports.monthly` 컬렉션 업데이트. 리포트는 사용자 데이터와 LLM을 기반으로 작동하도록 설정
   - 7-2. 리포트 구성 요소:
       1) 감정 추이 그래프: 날짜 x 감정 점수(joy, comfort, excitement 등).
       2) 활동 밸런스: 실내 vs 실외 비율, 활동 강도 차트.
       3) 추천 인사이트: "최근 우울 감정이 증가하여 밝은 조명 카페를 추천" 등.
       4) 챌린지 제안: 다음 달 목표 3가지.

8. **알림 & 재참여 유도**
   - 8-1. 알림 종류: 체크인 리마인더, 챌린지 달성/임박, 신상 추천, 리포트 발행, 파트너 활동 업데이트.
   - 8-2. 알림 채널: 앱 내 배지 + 이메일/푸시(선택 사항). 사용자 설정에서 채널 선택 가능.
   - 8-3. 홈 진입 시 "마지막 방문 이후 새롭게 추가된 장소" 섹션, "이번 주 미션" 카드로 재참여 유도.

9. **데이터/운영 관리**
   - 9-1. 관리자 포털: 장소 데이터 CRUD, 챌린지 템플릿 관리, 사용자 리포트 조회.
   - 9-2. ML 파이프라인 모니터링: 추천 모델 성능, 감정 분석 정확도, 사용자 피드백 수집.
   - 9-3. 파트너 제휴 장소 관리(추후) → 프로모션 배너/스폰서 추천 슬롯 운영.

**요약**: 위 단계별 플로우는 실제 UI 라우팅, API 설계, 데이터 모델링까지 연결할 수 있도록 상세히 기술하였다. 각 단계의 세부 시나리오를 기준으로 와이어프레임과 백로그를 작성하면 전체 서비스 기획을 빠르게 구체화할 수 있다.
